---
layout: post
title: "pwnable.kr random"
date: 2018-07-10 
tag: pwn Writeup pwnable.kr
---

> Daddy, teach me how to use random value in programming!
>
> ssh random@pwnable.kr -p2222 (pw:guest)

获得源码如下：

```c
#include <stdio.h>

int main(){
    unsigned int random;
    random = rand();    // random value!

    unsigned int key=0;
    scanf("%d", &key);

    if( (key ^ random) == 0xdeadbeef ){
        printf("Good!\n");
        system("/bin/cat flag");
        return 0;
    }

    printf("Wrong, maybe you should try 2^32 cases.\n");
    return 0;
}
```

发现rand没设种子，也就说每次生产的随机数都是一样的，所以输入一个与之异或值为 0xdeadbeef 的数就行了。

```c
// gcc -o rand rand.c
#include <stdio.h>
#include <stdlib.h>

int main()
{
    unsigned int random;
    random = rand();
    printf("%u\n", random ^ 0xdeadbeef);
    return 0;
}
```

编译运行上面的代码，每次获得的数都是 `3039230856`，把它输入服务器上的程序就ok了。

flag: Mommy, I thought libc random is unpredictable...
